const Map<int, int> xpLevelTotal = {
  1: 15,
  2: 304,
  3: 493,
  4: 711,
  5: 961,
  6: 1247,
  7: 1574,
  8: 1945,
  9: 2366,
  10: 2843,
  11: 3382,
  12: 3989,
  13: 4673,
  14: 5542,
  15: 6306,
  16: 7273,
  17: 8537,
  18: 9569,
  19: 10922,
  20: 12433,
  21: 14117,
  22: 15992,
  23: 18080,
  24: 20401,
  25: 22981,
  26: 25845,
  27: 29024,
  28: 32548,
  29: 36454,
  30: 40780,
  31: 45569,
  32: 50867,
  33: 56725,
  34: 63201,
  35: 70354,
  36: 78254,
  37: 86973,
  38: 96593,
  39: 107202,
  40: 118899,
  41: 131790,
  42: 145991,
  43: 161632,
  44: 178850,
  45: 197801,
  46: 218652,
  47: 241587,
  48: 266806,
  49: 294530,
  50: 325000,
  51: 358478,
  52: 395253,
  53: 435640,
  54: 479982,
  55: 528656,
  56: 582073,
  57: 640648,
  58: 704980,
  59: 775497,
  60: 858822,
  61: 973598,
  62: 1030523,
  63: 1132364,
  64: 1243956,
  65: 1366211,
  66: 1500266,
  67: 1646789,
  68: 1807388,
  69: 1983211,
  70: 2175702,
  71: 3857490,
  72: 5539279,
  73: 7221067,
  74: 8902856,
  75: 10584644,
  76: 34958287,
  77: 38667739,
  78: 42377192,
  79: 46086644,
  80: 49796096,
  81: 69149957,
  82: 73172858,
  83: 77195758,
  84: 81218659,
  85: 85241560,
};

double calculateXpProgress(int level, int xp) {
  if (level <= 0 || xpLevelTotal.isEmpty) return 0;

  // Di file xp-level.json, nilai tiap key adalah
  // maksimal XP untuk level tersebut. Jadi progress
  // cukup xp_saat_ini / xp_maks_level.
  final maxXp = xpLevelTotal[level];
  if (maxXp == null || maxXp <= 0) return 0;

  final clampedXp = xp.clamp(0, maxXp);
  final progress = clampedXp / maxXp;
  if (progress.isNaN) return 0;
  return progress.clamp(0.0, 1.0);
}

int currentXpInLevel(int level, int xp) {
  if (level <= 0 || xpLevelTotal.isEmpty) return 0;
  final maxXp = xpLevelTotal[level];
  if (maxXp == null || maxXp <= 0) return 0;
  return xp.clamp(0, maxXp);
}

int requiredXpForLevel(int level) {
  if (level <= 0 || xpLevelTotal.isEmpty) return 0;
  return xpLevelTotal[level] ?? 0;
}
